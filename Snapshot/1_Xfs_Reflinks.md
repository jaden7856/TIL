# Reflink란?

reflink는 커널 수준 지원이 필요하기 때문에 비교적 최근 릴리스에서만 XFS에서 사용할 수 있습니다. 

#### 사용가능 버전

- Ubuntu 
  - Ubuntu 18.04 버전 부터 사용 가능하며 더 나은 버전은 Ubuntu 20.04 입니다.

- Centos
  - Centos7 버전 부터 사용 가능합니다.

- Red Hat Enterprise Linux
  - Red Hat Enterprise Linux 6 버전 부터 사용 가능합니다.



## 1. 파일 시스템 유형 및 사용 사례
![img.png](1_Xfs_Reflinks.assets/1.png)

<br>
<br>

## 2. 로컬 파일 시스템
로컬 파일 시스템은 단일 로컬 서버에서 실행되고 스토리지에 직접 연결된 파일 시스템입니다.

예를 들어 로컬 파일 시스템은 내부 SATA 또는 SAS 디스크에 대한 유일한 선택 사항이며 서버에 로컬 드라이브가 있는 내부 하드웨어 
RAID 컨트롤러가 있는 경우에 사용됩니다. 로컬 파일 시스템은 SAN에서 내보낸 장치를 공유하지 않을 때 SAN에 연결된 스토리지에서 사용되는 
가장 일반적인 파일 시스템입니다.

<br>
<br>

## 3. XFS 파일 시스템
XFS는 단일 호스트에서 대용량 파일과 파일 시스템을 지원하는 확장성이 뛰어난 고성능, 강력하고 성숙한 64비트 저널링 파일 시스템입니다.
그리고 병렬 I/O 스트림을 처리할 수 있기 때문에 매우 생산적입니다. 따라서 대역폭을 쉽게 확장할 수 있고 동시에 여러 장치에서 작업해도 성능이 
하되지 않는 파일 시스템 입니다.

XFS의 기능은 다음과 같습니다.

### 신뢰성
- 메타데이터 저널링: 시스템을 다시 시작할 때 재생할 수 있는 파일 시스템 작업 기록을 유지하고 파일 시스템을 다시 마운트하여 
                  시스템 충돌 후 파일 시스템 무결성을 보장합니다.
- 광범위한 런타임 메타데이터 일관성 검사
- 확장 가능하고 빠른 복구 유틸리티
- 쿼터 저널링. 따라서 충돌 후 긴 할당량 일관성 검사가 필요하지 않습니다.

### 확장 및 성능
- 지원되는 파일 시스템 크기는 1024TiB까지 (32bit 에선 제한됩니다.)
- 다수의 동시 운영 지원 기능
- 여유 공간 관리의 확장성을 위한 B-tree 인덱싱
- 정교한 메타 데이터 읽기-ahead 알고리즘
- 동영상 워크로드를 스트리밍하기 위한 최적화

### 할당 체계
- 익스텐트 기반 할당
- 스트라이프 인식 정책
- 지연된 할당
- 공백 사전 할당
- 동적으로 할당된 inode

### 기타 기능
- **reflink 기반 파일 복사본**
- 긴밀하게 통합된 백업 및 복원 유틸리티
- 온라인 조각 모음
- 온라인 파일 시스템 확장
- 포괄적인 진단 기능
- 확장 속성(xattr). 이렇게 하면 시스템이 파일당 여러 추가 이름/값 쌍을 연결할 수 있습니다.
- 프로젝트 또는 디렉터리 할당량. 이렇게 하면 디렉터리 트리에 대한 할당량 제한이 허용됩니다.
- 서브초 타임스탬프

###성능 특징
XFS는 엔터프라이즈 워크로드가 포함된 대규모 시스템에서 고성능을 제공합니다. 대규모 시스템은 비교적 많은 CPU 수, 여러 HBA 및 외부 디스크 
어레이 연결을 사용하는 시스템입니다. XFS는 멀티 스레드 병렬 I/O 워크로드가 있는 소규모 시스템에서도 우수한 성능을 제공합니다.

XFS는 단일 스레드의 메타데이터를 많이 사용하는 워크로드(예: 단일 스레드에서 다수의 작은 파일을 생성하거나 삭제하는 워크로드)의 성능이 상대적으로 낮습니다.


---

### 참고
- https://access.redhat.com/documentation/ko-kr/red_hat_enterprise_linux/8/html-single/managing_file_systems/index